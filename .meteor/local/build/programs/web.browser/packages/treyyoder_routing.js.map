)]}'
{"version":3,"sources":["treyyoder:routing/routing.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,kB;AACA,kD;AACA,yD;AACA,W;AACA,sB;AACA,0B;AACA,oB;AACA,kB;AACA,oC;AACA,oE;AACA,6B;;AAEA,kE;AACA,4B;;AAEA,4B;AACA,iC;AACA,sB;AACA,I;;AAEA,8D;AACA,G;AACA,uC;AACA,mC;AACA,wC;AACA,+C;AACA,G;AACA,G;AACA,mC;AACA,oD;AACA,qB;AACA,iC;AACA,K;AACA,oC;AACA,oE;AACA,G;AACA,sB;AACA,qB;AACA,0D;AACA,6C;AACA,2D;AACA,gB;AACA,0B;AACA,0B;AACA,2C;AACA,+B;AACA,K;;AAEA,c;AACA,G;AACA,iC;AACA,+C;AACA,uC;AACA,0B;AACA,wB;AACA,G;AACA,sE;AACA,uE;AACA,uE;AACA,8B;;AAEA,iE;AACA,qC;;AAEA,0C;AACA,4C;;AAEA,G;AACA,0C;AACA,uE;AACA,4D;AACA,kE;AACA,I;AACA,G;AACA,E;AACA,C","file":"/packages/treyyoder_routing.js","sourcesContent":["Meteor.Routing = {\n\torigin : [ 61.220169, -149.901367 ], // Anchorage\n\tdestination : [ -53.163884, -70.917080 ], // PuntaArenas\n\ttrip : [],\n\ttripIntervals : null,\n\tcoordinateIntervals : [],\n\tinit : function() {\n\t\tvar self = this;\n\t\tself.trip[0] = L.Routing.control({\n\t\t\twaypoints : [ L.latLng(self.origin), L.latLng(self.destination) ]\n\t\t}).addTo(window.LUtil.map);\n\n\t\tinterval = setInterval(Meteor.Routing.getRouteCoordinates, 1000,\n\t\t\t\tMeteor.Routing.trip[0]);\n\n\t\tvar coordinateInterval = {\n\t\t\ttrip : Meteor.Routing.trip[0],\n\t\t\tinterval : interval\n\t\t};\n\n\t\tMeteor.Routing.coordinateIntervals.push(coordinateInterval);\n\t},\n\tgetRouteCoordinates : function(trip) {\n\t\tif (trip._routes !== undefined) {\n\t\t\tMeteor.Routing.startNavigation(trip);\n\t\t\tMeteor.Routing.stopGettingCoordinates(trip);\n\t\t}\n\t},\n\tstartNavigation : function(trip) {\n\t\tvar marker = new L.Marker(Meteor.Routing.origin, {\n\t\t\tdraggable : false,\n\t\t\ticon : Meteor.Routing.getCar()\n\t\t});\n\t\twindow.LUtil.map.addLayer(marker);\n\t\tnavInterval = setInterval(Meteor.Routing.drive, 50, marker, trip);\n\t},\n\tgetCar : function() {\n\t\tvar icon = L.icon({\n\t\t\ticonUrl : '/packages/treyyoder_routing/images/car.png',\n\t\t\ticonSize : [ 20, 40 ], // size of the icon\n\t\t\ticonAnchor : [ 7.5, 0 ], // point of the icon which will\n\t\t\t// correspond\n\t\t\t// to marker's location\n\t\t\tpopupAnchor : [ 0, 40 ]\n\t\t// point from which the popup should open\n\t\t// relative to the iconAnchor\n\t\t});\n\n\t\treturn icon;\n\t},\n\tdrive : function(marker, trip) {\n\t\tvar currentMilestone = marker.getMilestone();\n\t\tif (currentMilestone === undefined) {\n\t\t\tmarker.setMilestone(0);\n\t\t\tcurrentMilestone = 0;\n\t\t}\n\t\tvar currentPosition = trip._routes[0].coordinates[currentMilestone];\n\t\tvar nextPosition = trip._routes[0].coordinates[currentMilestone + 1];\n\t\tif (!isNaN(parseFloat(nextPosition[1])) && isFinite(nextPosition[1]))\n\t\t\t// map.panTo(nextPosition);\n\n\t\t\tMeteor.leafnav.rotateMarker(marker, Meteor.leafnav.getBearing(\n\t\t\t\t\tcurrentPosition, nextPosition));\n\n\t\tmarker.setLatLng(nextPosition).update();\n\t\tmarker.setMilestone(currentMilestone + 1);\n\n\t},\n\tstopGettingCoordinates : function(trip) {\n\t\tfor (var i = 0; i < Meteor.Routing.coordinateIntervals.length; i++) {\n\t\t\tif (Meteor.Routing.coordinateIntervals[i].trip == trip) {\n\t\t\t\tclearInterval(Meteor.Routing.coordinateIntervals[i].interval);\n\t\t\t}\n\t\t}\n\t}\n}"]}