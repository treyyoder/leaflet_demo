)]}'
{"version":3,"file":"/packages/fuatsengul:leaflet-routing-machine.js","sources":["fuatsengul:leaflet-routing-machine/fuatsengul:leaflet-routing-machine.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,e;;AAEA,yC;AACA,W;AACA,e;AACA,mB;AACA,uC;AACA,G;;AAEA,yD;AACA,8B;;AAEA,oB;AACA,kG;AACA,wH;AACA,kD;AACA,+E;AACA,qE;;AAEA,8E;AACA,yE;AACA,wC;AACA,sE;AACA,yE;AACA,qE;AACA,yD;AACA,sB;AACA,iB;AACA,I;AACA,W;AACA,G;;AAEA,oB;AACA,iF;AACA,uB;AACA,G;;AAEA,oB;AACA,uC;AACA,uC;AACA,iB;AACA,oE;AACA,W;AACA,0D;AACA,I;AACA,6D;AACA,uF;AACA,+D;AACA,G;;AAEA,8E;AACA,sB;AACA,G;;AAEA,iC;AACA,Q;AACA,S;AACA,S;AACA,W;;AAEA,yB;AACA,0B;;AAEA,wC;AACA,+D;AACA,G;;AAEA,wC;AACA,sD;AACA,2C;AACA,uC;AACA,mD;AACA,wB;AACA,iC;AACA,qF;AACA,sE;AACA,+E;AACA,G;;AAEA,W;AACA,sD;AACA,0E;AACA,gD;AACA,G;;AAEA,e;;AAEA,2B;AACA,4B;AACA,mB;AACA,G;AACA,G;;AAEA,+B;AACA,4B;AACA,gB;AACA,6B;AACA,oC;AACA,qB;AACA,W;AACA,G;;AAEA,2B;AACA,Y;;AAEA,4D;AACA,2E;AACA,gD;AACA,gC;AACA,U;AACA,G;;AAEA,yB;AACA,wC;AACA,U;AACA,G;;AAEA,oE;AACA,qB;AACA,8B;AACA,I;AACA,kG;AACA,0B;AACA,U;AACA,G;;AAEA,mB;AACA,G;;AAEA,yB;AACA,4B;AACA,Y;AACA,8E;AACA,0D;AACA,G;AACA,a;AACA,iE;AACA,G;;AAEA,Y;AACA,2E;AACA,yB;AACA,G;AACA,G;;AAEA,wB;AACA,wB;AACA,0F;AACA,G;AACA,yB;AACA,G;;AAEA,wB;AACA,qB;AACA,uB;AACA,Q;AACA,W;AACA,qB;AACA,iC;AACA,W;AACA,U;AACA,W;AACA,oB;AACA,iC;AACA,W;AACA,I;AACA,G;AACA,G;;AAEA,6C;AACA,2B;AACA,qC;AACA,+B;AACA,2C;AACA,uC;AACA,W;AACA,8B;AACA,I;AACA,G;;AAEA,W;AACA,U;AACA,G;;AAEA,sC;AACA,wC;AACA,yB;AACA,6C;AACA,G;AACA,E;AACA,G;;AAEA,+B;AACA,iE;AACA,yE;AACA,Y;AACA,4C;AACA,qD;AACA,2C;AACA,iC;AACA,kB;AACA,wB;AACA,8D;AACA,E;;AAEA,iC;AACA,W;AACA,mD;AACA,sB;AACA,G;;AAEA,gC;AACA,mC;AACA,iB;AACA,gB;AACA,I;AACA,G;;AAEA,gD;AACA,2C;;AAEA,wC;AACA,uD;AACA,oB;;AAEA,c;AACA,G;;AAEA,+D;AACA,gC;AACA,8B;AACA,2B;AACA,4B;AACA,6B;AACA,M;AACA,U;AACA,G;;AAEA,e;AACA,yC;AACA,uF;AACA,yE;AACA,0D;AACA,kC;AACA,M;AACA,Q;;AAEA,wC;AACA,iE;AACA,e;AACA,oD;AACA,mG;AACA,mF;AACA,sE;AACA,mC;AACA,O;AACA,I;AACA,G;;AAEA,0C;AACA,qC;AACA,G;;AAEA,sC;AACA,gB;AACA,kB;AACA,W;;AAEA,8C;AACA,wD;AACA,mC;;AAEA,6C;AACA,c;AACA,8B;AACA,I;AACA,G;;AAEA,wC;AACA,yB;AACA,mB;AACA,mF;AACA,G;;AAEA,mC;AACA,2C;AACA,G;;AAEA,4C;AACA,iC;AACA,U;AACA,iB;AACA,+B;AACA,gB;AACA,I;AACA,4D;AACA,6B;AACA,yE;AACA,G;AACA,G;;AAEA,gB;AACA,8G;AACA,wC;AACA,2B;AACA,c;AACA,Y;AACA,c;AACA,iB;;AAEA,uC;;AAEA,uB;AACA,S;AACA,iB;AACA,kB;AACA,O;AACA,yC;AACA,kC;AACA,e;AACA,uB;AACA,8D;AACA,e;AACA,a;AACA,c;AACA,O;AACA,yC;AACA,kC;AACA,e;AACA,uB;AACA,8D;AACA,e;AACA,gE;AACA,oD;AACA,G;AACA,e;AACA,G;;AAEA,yC;AACA,U;AACA,6C;AACA,oC;AACA,I;AACA,G;;AAEA,mD;AACA,kB;AACA,Q;AACA,Y;AACA,W;AACA,e;;AAEA,iD;AACA,+B;AACA,+C;AACA,kC;AACA,c;AACA,iB;AACA,gB;AACA,wB;AACA,oB;AACA,oB;AACA,yB;AACA,yD;AACA,oB;AACA,O;AACA,I;AACA,G;;AAEA,gB;AACA,G;;AAEA,qC;AACA,4B;AACA,S;AACA,qB;AACA,S;AACA,wB;AACA,S;AACA,kB;AACA,S;AACA,uB;AACA,S;AACA,uB;AACA,S;AACA,sB;AACA,S;AACA,iB;AACA,S;AACA,wB;AACA,S;AACA,4B;AACA,U;AACA,qB;AACA,kG;AACA,qB;AACA,U;AACA,U;AACA,uB;AACA,U;AACA,+B;AACA,U;AACA,e;AACA,G;AACA,E;AACA,G;;AAEA,oC;AACA,oC;AACA,E;;AAEA,iC;AACA,0B;;AAEA,W;AACA,W;AACA,8C;AACA,6C;AACA,2C;AACA,I;AACA,oB;AACA,G;;AAEA,uC;AACA,mC;AACA,sB;;AAEA,gD;AACA,G;;AAEA,uB;AACA,qB;AACA,c;AACA,G;;AAEA,uB;AACA,qC;AACA,Q;AACA,S;;AAEA,kB;AACA,oB;AACA,oD;AACA,gD;AACA,gB;AACA,mC;AACA,kD;AACA,I;AACA,yB;AACA,G;AACA,G;;AAEA,0B;AACA,Q;AACA,6C;AACA,oC;AACA,G;;AAEA,mB;AACA,G;;AAEA,wB;AACA,iD;AACA,G;;AAEA,mC;AACA,kC;AACA,mB;AACA,Q;AACA,oC;AACA,+D;AACA,G;;AAEA,iB;AACA,G;;AAEA,2C;AACA,iC;AACA,Y;AACA,Q;AACA,Q;;AAEA,8D;AACA,iD;AACA,qD;AACA,qB;AACA,iB;AACA,gB;AACA,I;AACA,G;;AAEA,kB;AACA,G;;AAEA,oC;AACA,qC;AACA,4C;AACA,O;AACA,G;;AAEA,W;AACA,G;;AAEA,8B;AACA,oF;AACA,4B;AACA,0B;AACA,mB;AACA,K;AACA,G;AACA,G;;AAEA,2C;AACA,2C;AACA,E;;AAEA,wC;AACA,0B;;AAEA,W;AACA,kB;AACA,qB;AACA,a;AACA,iB;AACA,sB;AACA,c;AACA,mB;AACA,I;AACA,gE;AACA,qC;AACA,yB;AACA,c;AACA,e;AACA,oB;AACA,e;AACA,e;AACA,c;AACA,kB;AACA,e;AACA,I;AACA,yB;AACA,2B;AACA,yB;AACA,yB;AACA,yB;AACA,Y;AACA,G;;AAEA,gC;AACA,8B;AACA,G;;AAEA,oB;AACA,sF;AACA,iE;AACA,oC;AACA,sD;AACA,qE;AACA,iC;AACA,K;AACA,yB;AACA,G;;AAEA,uB;AACA,G;;AAEA,oC;AACA,Q;AACA,U;AACA,a;;AAEA,oB;;AAEA,wB;;AAEA,6C;AACA,yB;AACA,4C;AACA,uC;AACA,kC;AACA,G;;AAEA,uD;;AAEA,c;AACA,G;;AAEA,mB;AACA,2E;AACA,G;;AAEA,mB;AACA,wE;AACA,G;;AAEA,uC;AACA,+D;AACA,sC;AACA,uF;AACA,oE;AACA,kB;AACA,6D;AACA,gD;AACA,K;AACA,oE;;AAEA,sD;AACA,gB;AACA,G;;AAEA,yB;AACA,Q;AACA,O;AACA,mC;AACA,4E;AACA,qC;AACA,wD;AACA,qC;AACA,Q;AACA,I;AACA,G;;AAEA,yB;AACA,G;;AAEA,qC;AACA,yE;AACA,kD;AACA,Q;AACA,Y;AACA,U;AACA,S;;AAEA,+C;AACA,6B;AACA,0C;AACA,wC;AACA,wE;AACA,wC;AACA,iF;AACA,0D;AACA,G;;AAEA,e;AACA,G;;AAEA,8C;AACA,mB;AACA,a;AACA,uD;AACA,sC;AACA,sD;AACA,K;AACA,sD;AACA,gB;AACA,mC;AACA,kB;AACA,I;AACA,K;AACA,oD;AACA,gC;AACA,iC;AACA,K;AACA,G;;AAEA,6B;AACA,c;AACA,Q;AACA,Q;AACA,yB;AACA,c;;AAEA,gD;AACA,+D;AACA,mC;AACA,G;;AAEA,qE;AACA,mD;AACA,6B;AACA,uC;AACA,8D;AACA,2D;AACA,0C;AACA,4D;AACA,K;;AAEA,6B;AACA,2D;AACA,0D;AACA,K;AACA,I;AACA,G;;AAEA,qB;AACA,G;;AAEA,qD;AACA,kC;AACA,Q;AACA,Q;;AAEA,0C;AACA,oB;AACA,mB;AACA,Y;AACA,oC;AACA,mB;AACA,M;AACA,W;AACA,Y;AACA,mC;AACA,mB;AACA,M;AACA,I;AACA,U;AACA,sB;AACA,W;AACA,sC;AACA,+C;AACA,K;AACA,G;;AAEA,8D;AACA,G;;AAEA,sB;AACA,+F;AACA,6B;AACA,mC;;AAEA,+B;AACA,G;;AAEA,kD;AACA,kB;AACA,sC;AACA,wB;AACA,wC;AACA,yC;AACA,uB;AACA,sC;AACA,sB;AACA,wC;AACA,oB;AACA,U;AACA,mB;AACA,G;AACA,G;;AAEA,mC;AACA,iC;AACA,iE;AACA,oF;AACA,a;AACA,U;AACA,qB;AACA,G;AACA,G;;AAEA,8C;AACA,uB;AACA,kB;AACA,wF;AACA,qB;AACA,8D;AACA,e;AACA,uD;AACA,oB;AACA,6D;AACA,oB;AACA,wB;AACA,mB;AACA,4D;AACA,c;AACA,sD;AACA,oB;AACA,6D;AACA,yB;AACA,6B;AACA,oB;AACA,oD;AACA,4B;AACA,iC;AACA,G;AACA,G;;AAEA,4B;AACA,qB;AACA,+B;;AAEA,8C;AACA,G;;AAEA,Q;AACA,a;AACA,kB;AACA,Y;AACA,kB;AACA,a;AACA,kB;AACA,Y;AACA,iB;AACA,E;AACA,G;;AAEA,qC;AACA,E;;AAEA,wC;AACA,wC;AACA,E;;AAEA,+B;AACA,sC;AACA,wB;AACA,oB;AACA,G;AACA,I;;;AAGA,iC;AACA,0B;;AAEA,W;AACA,e;AACA,8C;AACA,6C;AACA,8D;AACA,I;AACA,2B;AACA,qB;AACA,4B;AACA,0B;AACA,yB;AACA,qD;AACA,mB;AACA,a;AACA,8B;AACA,oB;AACA,e;AACA,I;AACA,6B;AACA,a;AACA,G;AACA,G;;AAEA,2C;AACA,mC;AACA,uB;AACA,+B;AACA,G;;AAEA,sB;AACA,Q;AACA,gD;AACA,oC;AACA,iB;AACA,I;AACA,G;;AAEA,c;AACA,G;;AAEA,2B;AACA,Q;AACA,Y;;AAEA,gD;AACA,gC;AACA,G;;AAEA,a;AACA,G;;AAEA,oC;AACA,2D;AACA,yC;AACA,c;AACA,G;;AAEA,8B;AACA,0C;AACA,Q;AACA,S;;AAEA,0C;AACA,gH;AACA,G;;AAEA,yC;;AAEA,sC;AACA,uB;AACA,4B;AACA,iB;AACA,G;;AAEA,wB;AACA,sC;AACA,G;;AAEA,uB;AACA,kB;AACA,wB;AACA,G;;AAEA,uB;AACA,Q;AACA,wB;;AAEA,oB;AACA,mD;AACA,gD;AACA,I;AACA,G;;AAEA,mB;AACA,G;;AAEA,8B;AACA,0G;AACA,+B;AACA,Q;AACA,mB;AACA,e;;AAEA,sC;AACA,2B;;AAEA,0C;AACA,0C;AACA,uC;AACA,0C;AACA,G;;AAEA,uD;AACA,0C;AACA,2B;AACA,kC;AACA,yD;AACA,oD;AACA,Y;AACA,U;AACA,mC;AACA,G;;AAEA,qD;;AAEA,mB;AACA,G;;AAEA,+B;AACA,mD;AACA,2B;AACA,wG;AACA,iF;;AAEA,4C;AACA,kE;AACA,iB;AACA,+D;AACA,+B;;AAEA,4D;AACA,iB;AACA,mB;;AAEA,wD;AACA,gC;AACA,qB;AACA,yB;AACA,0B;AACA,wB;AACA,sB;AACA,4C;AACA,yC;AACA,kD;AACA,8C;AACA,yC;;AAEA,sB;AACA,G;;AAEA,gC;AACA,oB;AACA,Q;AACA,mB;AACA,iB;;AAEA,0D;AACA,8C;AACA,0C;AACA,kD;AACA,U;AACA,6C;AACA,G;;AAEA,2C;AACA,wC;AACA,oD;AACA,kE;AACA,+B;AACA,G;AACA,uB;;AAEA,oD;AACA,+D;AACA,G;;AAEA,6C;AACA,iD;;AAEA,oD;AACA,oG;AACA,4F;AACA,G;AACA,G;;AAEA,6C;AACA,8B;AACA,2C;AACA,6B;AACA,G;;AAEA,wD;AACA,8B;;AAEA,0B;;AAEA,yC;AACA,gE;AACA,mF;AACA,mG;AACA,2B;AACA,a;AACA,mB;AACA,M;AACA,2C;AACA,a;AACA,W;AACA,iB;AACA,I;;AAEA,yC;AACA,G;;AAEA,G;;AAEA,6B;AACA,Q;AACA,sB;AACA,+C;AACA,2B;AACA,6C;AACA,K;AACA,I;AACA,G;AACA,qB;AACA,G;;AAEA,6B;AACA,Q;AACA,W;AACA,Q;;AAEA,mB;AACA,U;AACA,G;;AAEA,wB;;AAEA,gD;AACA,mC;AACA,+D;AACA,oF;AACA,+B;AACA,oC;AACA,0C;AACA,oC;AACA,K;AACA,W;AACA,a;AACA,I;AACA,yB;AACA,G;AACA,G;;AAEA,mC;AACA,iB;AACA,kB;AACA,I;AACA,a;AACA,uB;AACA,G;;AAEA,uE;AACA,G;;AAEA,2B;AACA,kE;;AAEA,8B;AACA,kC;AACA,iD;AACA,oD;AACA,oB;AACA,M;AACA,G;AACA,G;;AAEA,sC;AACA,iC;AACA,mE;AACA,W;AACA,4B;AACA,8D;AACA,W;AACA,+B;AACA,iE;AACA,oD;AACA,gC;AACA,6D;AACA,uB;AACA,W;AACA,G;;AAEA,uC;AACA,kD;AACA,G;;AAEA,+B;AACA,Q;AACA,iB;AACA,4B;AACA,+C;AACA,Y;AACA,I;;AAEA,wD;AACA,sC;AACA,yC;AACA,a;AACA,4C;AACA,oD;AACA,G;;AAEA,gE;AACA,qD;AACA,mD;AACA,G;;AAEA,4B;AACA,Q;AACA,yC;AACA,kD;AACA,sD;AACA,G;AACA,G;;AAEA,4B;AACA,Q;AACA,oD;AACA,sD;AACA,kD;AACA,+C;AACA,G;AACA,gE;AACA,qB;AACA,E;AACA,G;;AAEA,+C;AACA,+C;AACA,E;;AAEA,gD;AACA,W;AACA,yB;AACA,G;;AAEA,gC;AACA,mC;;AAEA,6D;AACA,mG;AACA,8B;AACA,uD;AACA,G;AACA,+B;AACA,mD;AACA,G;;AAEA,+D;;AAEA,sD;AACA,iD;AACA,iB;AACA,2D;AACA,W;;AAEA,gB;AACA,G;;AAEA,uB;AACA,sE;;AAEA,kB;AACA,iC;;AAEA,8B;AACA,8E;AACA,G;;AAEA,mB;AACA,G;;AAEA,0B;AACA,mB;AACA,+B;AACA,G;AACA,8B;AACA,gE;AACA,G;;AAEA,2B;AACA,mC;AACA,G;;AAEA,oC;AACA,qC;AACA,c;AACA,G;;AAEA,8B;AACA,wE;AACA,iB;AACA,G;;AAEA,sB;AACA,oB;AACA,G;;AAEA,8B;AACA,sB;AACA,oB;;AAEA,+D;AACA,8B;AACA,+B;;AAEA,uC;AACA,+C;AACA,G;AACA,G;;AAEA,2B;AACA,mC;AACA,iC;AACA,W;AACA,G;;AAEA,qB;AACA,U;;AAEA,oB;AACA,oB;;AAEA,6B;AACA,mC;AACA,+C;AACA,kD;AACA,c;AACA,6C;AACA,Y;AACA,K;AACA,+D;AACA,iC;AACA,Y;AACA,G;AACA,G;;AAEA,yB;AACA,mB;AACA,qC;AACA,qB;AACA,G;AACA,E;AACA,G;;AAEA,uC;AACA,uC;AACA,E","sourcesContent":["L.Routing = {};\n\nL.Routing.Autocomplete = L.Class.extend({\n\toptions: {\n\t\ttimeout: 500,\n\t\tblurTimeout: 100,\n\t\tnoResultsMessage: 'No results found.'\n\t},\n\n\tinitialize: function(elem, callback, context, options) {\n\t\tL.setOptions(this, options);\n\n\t\tthis._elem = elem;\n\t\tthis._resultFn = options.resultFn ? L.Util.bind(options.resultFn, options.resultContext) : null;\n\t\tthis._autocomplete = options.autocompleteFn ? L.Util.bind(options.autocompleteFn, options.autocompleteContext) : null;\n\t\tthis._selectFn = L.Util.bind(callback, context);\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-routing-geocoder-result');\n\t\tthis._resultTable = L.DomUtil.create('table', '', this._container);\n\n\t\t// TODO: looks a bit like a kludge to register same for input and keypress -\n\t\t// browsers supporting both will get duplicate events; just registering\n\t\t// input will not catch enter, though.\n\t\tL.DomEvent.addListener(this._elem, 'input', this._keyPressed, this);\n\t\tL.DomEvent.addListener(this._elem, 'keypress', this._keyPressed, this);\n\t\tL.DomEvent.addListener(this._elem, 'keydown', this._keyDown, this);\n\t\tL.DomEvent.addListener(this._elem, 'blur', function() {\n\t\t\tif (this._isOpen) {\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}, this);\n\t},\n\n\tclose: function() {\n\t\tL.DomUtil.removeClass(this._container, 'leaflet-routing-geocoder-result-open');\n\t\tthis._isOpen = false;\n\t},\n\n\t_open: function() {\n\t\tvar sibling = this._elem.nextSibling;\n\t\tif (!this._container.parentElement) {\n\t\t\tif (sibling) {\n\t\t\t\tthis._elem.parentElement.insertBefore(this._container, sibling);\n\t\t\t} else {\n\t\t\t\tthis._elem.parentElement.appendChild(this._container);\n\t\t\t}\n\t\t\tthis._container.style.left = this._elem.offsetLeft + 'px';\n\t\t\tthis._container.style.top = (this._elem.offsetTop + this._elem.offsetHeight) + 'px';\n\t\t\tthis._container.style.width = this._elem.offsetWidth + 'px';\n\t\t}\n\n\t\tL.DomUtil.addClass(this._container, 'leaflet-routing-geocoder-result-open');\n\t\tthis._isOpen = true;\n\t},\n\n\t_setResults: function(results) {\n\t\tvar i,\n\t\t    tr,\n\t\t    td,\n\t\t    text;\n\n\t\tdelete this._selection;\n\t\tthis._results = results;\n\n\t\twhile (this._resultTable.firstChild) {\n\t\t\tthis._resultTable.removeChild(this._resultTable.firstChild);\n\t\t}\n\n\t\tfor (i = 0; i < results.length; i++) {\n\t\t\ttr = L.DomUtil.create('tr', '', this._resultTable);\n\t\t\ttr.setAttribute('data-result-index', i);\n\t\t\ttd = L.DomUtil.create('td', '', tr);\n\t\t\ttext = document.createTextNode(results[i].name);\n\t\t\ttd.appendChild(text);\n\t\t\t// mousedown + click because: \n\t\t\t// http://stackoverflow.com/questions/10652852/jquery-fire-click-before-blur-event\n\t\t\tL.DomEvent.addListener(td, 'mousedown', L.DomEvent.preventDefault);\n\t\t\tL.DomEvent.addListener(td, 'click', this._resultSelected(results[i]), this);\n\t\t}\n\n\t\tif (!i) {\n\t\t\ttr = L.DomUtil.create('tr', '', this._resultTable);\n\t\t\ttd = L.DomUtil.create('td', 'leaflet-routing-geocoder-no-results', tr);\n\t\t\ttd.innerHTML = this.options.noResultsMessage;\n\t\t}\n\n\t\tthis._open();\n\n\t\tif (results.length > 0) {\n\t\t\t// Select the first entry\n\t\t\tthis._select(1);\n\t\t}\n\t},\n\n\t_resultSelected: function(r) {\n\t\treturn L.bind(function() {\n\t\t\tthis.close();\n\t\t\tthis._elem.value = r.name;\n\t\t\tthis._lastCompletedText = r.name;\n\t\t\tthis._selectFn(r);\n\t\t}, this);\n\t},\n\n\t_keyPressed: function(e) {\n\t\tvar index;\n\n\t\tif (this._isOpen && e.keyCode === 13 && this._selection) {\n\t\t\tindex = parseInt(this._selection.getAttribute('data-result-index'), 10);\n\t\t\tthis._resultSelected(this._results[index])();\n\t\t\tL.DomEvent.preventDefault(e);\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.keyCode === 13) {\n\t\t\tthis._complete(this._resultFn, true);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._autocomplete && document.activeElement === this._elem) {\n\t\t\tif (this._timer) {\n\t\t\t\tclearTimeout(this._timer);\n\t\t\t}\n\t\t\tthis._timer = setTimeout(L.Util.bind(function() { this._complete(this._autocomplete); }, this),\n\t\t\t\tthis.options.timeout);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._unselect();\n\t},\n\n\t_select: function(dir) {\n\t\tvar sel = this._selection;\n\t\tif (sel) {\n\t\t\tL.DomUtil.removeClass(sel.firstChild, 'leaflet-routing-geocoder-selected');\n\t\t\tsel = sel[dir > 0 ? 'nextSibling' : 'previousSibling'];\n\t\t}\n\t\tif (!sel) {\n\t\t\tsel = this._resultTable[dir > 0 ? 'firstChild' : 'lastChild'];\n\t\t}\n\n\t\tif (sel) {\n\t\t\tL.DomUtil.addClass(sel.firstChild, 'leaflet-routing-geocoder-selected');\n\t\t\tthis._selection = sel;\n\t\t}\n\t},\n\n\t_unselect: function() {\n\t\tif (this._selection) {\n\t\t\tL.DomUtil.removeClass(this._selection.firstChild, 'leaflet-routing-geocoder-selected');\n\t\t}\n\t\tdelete this._selection;\n\t},\n\n\t_keyDown: function(e) {\n\t\tif (this._isOpen) {\n\t\t\tswitch (e.keyCode) {\n\t\t\t// Up\n\t\t\tcase 38:\n\t\t\t\tthis._select(-1);\n\t\t\t\tL.DomEvent.preventDefault(e);\n\t\t\t\treturn;\n\t\t\t// Down\n\t\t\tcase 40:\n\t\t\t\tthis._select(1);\n\t\t\t\tL.DomEvent.preventDefault(e);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\n\t_complete: function(completeFn, trySelect) {\n\t\tvar v = this._elem.value;\n\t\tfunction completeResults(results) {\n\t\t\tthis._lastCompletedText = v;\n\t\t\tif (trySelect && results.length === 1) {\n\t\t\t\tthis._resultSelected(results[0])();\n\t\t\t} else {\n\t\t\t\tthis._setResults(results);\n\t\t\t}\n\t\t}\n\n\t\tif (!v) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (v !== this._lastCompletedText) {\n\t\t\tcompleteFn(v, completeResults, this);\n\t\t} else if (trySelect) {\n\t\t\tcompleteResults.call(this, this._results);\n\t\t}\n\t}\n});\n\nL.Routing._jsonpCallbackId = 0;\nL.Routing._jsonp = function(url, callback, context, jsonpParam) {\n\tvar callbackId = '_l_routing_machine_' + (L.Routing._jsonpCallbackId++),\n\t    script;\n\turl += '&' + jsonpParam + '=' + callbackId;\n\twindow[callbackId] = L.Util.bind(callback, context);\n\tscript = document.createElement('script');\n\tscript.type = 'text/javascript';\n\tscript.src = url;\n\tscript.id = callbackId;\n\tdocument.getElementsByTagName('head')[0].appendChild(script);\n};\n\nL.Routing.OSRM = L.Class.extend({\n\toptions: {\n\t\tserviceUrl: '//router.project-osrm.org/viaroute',\n\t\tgeometryPrecision: 6\n\t},\n\n\tinitialize: function(options) {\n\t\tL.Util.setOptions(this, options);\n\t\tthis._hints = {\n\t\t\tlocations: {}\n\t\t};\n\t},\n\n\troute: function(waypoints, callback, context) {\n\t\tvar url = this._buildRouteUrl(waypoints);\n\n\t\tL.Routing._jsonp(url, function(data) {\n\t\t\tthis._routeDone(data, waypoints, callback, context);\n\t\t}, this, 'jsonp');\n\n\t\treturn this;\n\t},\n\n\t_routeDone: function(response, waypoints, callback, context) {\n\t\tcontext = context || callback;\n\t\tif (response.status !== 0) {\n\t\t\tcallback.call(context, {\n\t\t\t\tstatus: response.status,\n\t\t\t\tmessage: response.message\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tvar alts = [{\n\t\t\t\tname: response.route_name.join(', '),\n\t\t\t\tcoordinates: this._decode(response.route_geometry, this.options.geometryPrecision),\n\t\t\t\tinstructions: this._convertInstructions(response.route_instructions),\n\t\t\t\tsummary: this._convertSummary(response.route_summary),\n\t\t\t\twaypoints: response.via_points\n\t\t\t}],\n\t\t    i;\n\n\t\tif (response.alternative_geometries) {\n\t\t\tfor (i = 0; i < response.alternative_geometries.length; i++) {\n\t\t\t\talts.push({\n\t\t\t\t\tname: response.alternative_names[i].join(', '),\n\t\t\t\t\tcoordinates: this._decode(response.alternative_geometries[i], this.options.geometryPrecision),\n\t\t\t\t\tinstructions: this._convertInstructions(response.alternative_instructions[i]),\n\t\t\t\t\tsummary: this._convertSummary(response.alternative_summaries[i]),\n\t\t\t\t\twaypoints: response.via_points\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._saveHintData(response, waypoints);\n\t\tcallback.call(context, null, alts);\n\t},\n\n\t_buildRouteUrl: function(waypoints) {\n\t\tvar locs = [],\n\t\t    locationKey,\n\t\t    hint;\n\n\t\tfor (var i = 0; i < waypoints.length; i++) {\n\t\t\tlocationKey = this._locationKey(waypoints[i].latLng);\n\t\t\tlocs.push('loc=' + locationKey);\n\n\t\t\thint = this._hints.locations[locationKey];\n\t\t\tif (hint) {\n\t\t\t\tlocs.push('hint=' + hint);\n\t\t\t}\n\t\t}\n\n\t\treturn this.options.serviceUrl + '?' +\n\t\t\t'instructions=true&' +\n\t\t\tlocs.join('&') +\n\t\t\t(this._hints.checksum !== undefined ? '&checksum=' + this._hints.checksum : '');\n\t},\n\n\t_locationKey: function(location) {\n\t\treturn location.lat + ',' + location.lng;\n\t},\n\n\t_saveHintData: function(route, waypoints) {\n\t\tvar hintData = route.hint_data,\n\t\t    loc;\n\t\tthis._hints = {\n\t\t\tchecksum: hintData.checksum,\n\t\t\tlocations: {}\n\t\t};\n\t\tfor (var i = hintData.locations.length - 1; i >= 0; i--) {\n\t\t\tloc = waypoints[i].latLng;\n\t\t\tthis._hints.locations[this._locationKey(loc)] = hintData.locations[i];\n\t\t}\n\t},\n\n\t// Adapted from\n\t// https://github.com/DennisSchiefer/Project-OSRM-Web/blob/develop/WebContent/routing/OSRM.RoutingGeometry.js\n\t_decode: function(encoded, precision) {\n\t\tvar len = encoded.length,\n\t\t    index=0,\n\t\t    lat=0,\n\t\t    lng = 0,\n\t\t    array = [];\n\n\t\tprecision = Math.pow(10, -precision);\n\n\t\twhile (index < len) {\n\t\t\tvar b,\n\t\t\t    shift = 0,\n\t\t\t    result = 0;\n\t\t\tdo {\n\t\t\t\tb = encoded.charCodeAt(index++) - 63;\n\t\t\t\tresult |= (b & 0x1f) << shift;\n\t\t\t\tshift += 5;\n\t\t\t} while (b >= 0x20);\n\t\t\tvar dlat = ((result & 1) ? ~(result >> 1) : (result >> 1));\n\t\t\tlat += dlat;\n\t\t\tshift = 0;\n\t\t\tresult = 0;\n\t\t\tdo {\n\t\t\t\tb = encoded.charCodeAt(index++) - 63;\n\t\t\t\tresult |= (b & 0x1f) << shift;\n\t\t\t\tshift += 5;\n\t\t\t} while (b >= 0x20);\n\t\t\tvar dlng = ((result & 1) ? ~(result >> 1) : (result >> 1));\n\t\t\tlng += dlng;\n\t\t\t//array.push( {lat: lat * precision, lng: lng * precision} );\n\t\t\tarray.push( [lat * precision, lng * precision] );\n\t\t}\n\t\treturn array;\n\t},\n\n\t_convertSummary: function(osrmSummary) {\n\t\treturn {\n\t\t\ttotalDistance: osrmSummary.total_distance,\n\t\t\ttotalTime: osrmSummary.total_time\n\t\t};\n\t},\n\n\t_convertInstructions: function(osrmInstructions) {\n\t\tvar result = [],\n\t\t    i,\n\t\t    instr,\n\t\t    type,\n\t\t    driveDir;\n\n\t\tfor (i = 0; i < osrmInstructions.length; i++) {\n\t\t\tinstr = osrmInstructions[i];\n\t\t\ttype = this._drivingDirectionType(instr[0]);\n\t\t\tdriveDir = instr[0].split('-');\n\t\t\tif (type) {\n\t\t\t\tresult.push({\n\t\t\t\t\ttype: type,\n\t\t\t\t\tdistance: instr[2],\n\t\t\t\t\ttime: instr[4],\n\t\t\t\t\troad: instr[1],\n\t\t\t\t\tdirection: instr[6],\n\t\t\t\t\texit: driveDir.length > 1 ? driveDir[1] : undefined,\n\t\t\t\t\tindex: instr[3]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t},\n\n\t_drivingDirectionType: function(d) {\n\t\tswitch (parseInt(d, 10)) {\n\t\tcase 1:\n\t\t\treturn 'Straight';\n\t\tcase 2:\n\t\t\treturn 'SlightRight';\n\t\tcase 3:\n\t\t\treturn 'Right';\n\t\tcase 4:\n\t\t\treturn 'SharpRight';\n\t\tcase 5:\n\t\t\treturn 'TurnAround';\n\t\tcase 6:\n\t\t\treturn 'SharpLeft';\n\t\tcase 7:\n\t\t\treturn 'Left';\n\t\tcase 8:\n\t\t\treturn 'SlightRight';\n\t\tcase 9:\n\t\t\treturn 'WaypointReached';\n\t\tcase 10:\n\t\t\t// TODO: \"Head on\"\n\t\t\t// https://github.com/DennisOSRM/Project-OSRM/blob/master/DataStructures/TurnInstructions.h#L48\n\t\t\treturn 'Straight';\n\t\tcase 11:\n\t\tcase 12:\n\t\t\treturn 'Roundabout';\n\t\tcase 15:\n\t\t\treturn 'DestinationReached';\n\t\tdefault:\n\t\t\treturn null;\n\t\t}\n\t}\n});\n\nL.Routing.osrm = function(options) {\n\treturn new L.Routing.OSRM(options);\n};\n\nL.Routing.Line = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tstyles: [\n\t\t\t{color: 'black', opacity: 0.15, weight: 7},\n\t\t\t{color: 'white', opacity: 0.8, weight: 4},\n\t\t\t{color: 'orange', opacity: 1, weight: 2}\n\t\t],\n\t\taddWaypoints: true\n\t},\n\n\tinitialize: function(route, options) {\n\t\tL.Util.setOptions(this, options);\n\t\tthis._route = route;\n\n\t\tthis._wpIndices = this._findWaypointIndices();\n\t},\n\n\taddTo: function(map) {\n\t\tmap.addLayer(this);\n\t\treturn this;\n\t},\n\n\tonAdd: function(map) {\n\t\tvar geom = this._route.coordinates,\n\t\t    i,\n\t\t    pl;\n\n\t\tthis._map = map;\n\t\tthis._layers = [];\n\t\tfor (i = 0; i < this.options.styles.length; i++) {\n\t\t\tpl = L.polyline(geom, this.options.styles[i])\n\t\t\t\t.addTo(map);\n\t\t\tif (this.options.addWaypoints) {\n\t\t\t\tpl.on('mousedown', this._onLineTouched, this);\n\t\t\t}\n\t\t\tthis._layers.push(pl);\n\t\t}\n\t},\n\n\tonRemove: function(map) {\n\t\tvar i;\n\t\tfor (i = 0; i < this._layers.length; i++) {\n\t\t\tmap.removeLayer(this._layers[i]);\n\t\t}\n\n\t\tdelete this._map;\n\t},\n\n\tgetBounds: function() {\n\t\treturn L.latLngBounds(this._route.coordinates);\n\t},\n\n\t_findWaypointIndices: function() {\n\t\tvar wps = this._route.waypoints,\n\t\t    indices = [],\n\t\t    i;\n\t\tfor (i = 0; i < wps.length; i++) {\n\t\t\tindices.push(this._findClosestRoutePoint(L.latLng(wps[i])));\n\t\t}\n\n\t\treturn indices;\n\t},\n\n\t_findClosestRoutePoint: function(latlng) {\n\t\tvar minDist = Number.MAX_VALUE,\n\t\t\tminIndex,\n\t\t    i,\n\t\t    d;\n\n\t\tfor (i = this._route.coordinates.length - 1; i >= 0 ; i--) {\n\t\t\t// TODO: maybe do this in pixel space instead?\n\t\t\td = latlng.distanceTo(this._route.coordinates[i]);\n\t\t\tif (d < minDist) {\n\t\t\t\tminIndex = i;\n\t\t\t\tminDist = d;\n\t\t\t}\n\t\t}\n\n\t\treturn minIndex;\n\t},\n\n\t_findNearestWpBefore: function(i) {\n\t\tvar j = this._wpIndices.length - 1;\n\t\twhile (j >= 0 && this._wpIndices[j] > i) {\n\t\t\tj--;\n\t\t}\n\n\t\treturn j;\n\t},\n\n\t_onLineTouched: function(e) {\n\t\tvar afterIndex = this._findNearestWpBefore(this._findClosestRoutePoint(e.latlng));\n\t\tthis.fire('linetouched', {\n\t\t\tafterIndex: afterIndex,\n\t\t\tlatlng: e.latlng\n\t\t});\n\t},\n});\n\nL.Routing.line = function(route, options) {\n\treturn new L.Routing.Line(route, options);\n};\n\nL.Routing.Itinerary = L.Control.extend({\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tunits: 'metric',\n\t\tpointMarkerStyle: {\n\t\t\tradius: 5,\n\t\t\tcolor: '#03f',\n\t\t\tfillColor: 'white',\n\t\t\topacity: 1,\n\t\t\tfillOpacity: 0.7\n\t\t},\n\t\tsummaryTemplate: '<h2>{name}</h2><h3>{distance}, {time}</h3>',\n\t\tdistanceTemplate: '{value} {unit}',\n\t\ttimeTemplate: '{time}',\n\t\tunitNames: {\n\t\t\tmeters: 'm',\n\t\t\tkilometers: 'km',\n\t\t\tyards: 'yd',\n\t\t\tmiles: 'mi',\n\t\t\thours: 'h',\n\t\t\tminutes: 'mín',\n\t\t\tseconds: 's'\n\t\t},\n\t\tcontainerClassName: '',\n\t\talternativeClassName: '',\n\t\tminimizedClassName: '',\n\t\titineraryClassName: '',\n\t\troundingSensitivity: 1,\n\t\tshow: true\n\t},\n\n\tinitialize: function(options) {\n\t\tL.setOptions(this, options);\n\t},\n\n\tonAdd: function() {\n\t\tthis._container = L.DomUtil.create('div', 'leaflet-routing-container leaflet-bar ' +\n\t\t\t(!this.options.show ? 'leaflet-routing-container-hide' : '') +\n\t\t\tthis.options.containerClassName);\n\t\tL.DomEvent.disableClickPropagation(this._container);\n\t\tL.DomEvent.addListener(this._container, 'mousewheel', function(e) {\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\t});\n\t\treturn this._container;\n\t},\n\n\tonRemove: function() {\n\t},\n\n\tsetAlternatives: function(routes) {\n\t\tvar i,\n\t\t    alt,\n\t\t    altDiv;\n\n\t\tthis._clearAlts();\n\n\t\tthis._routes = routes;\n\n\t\tfor (i = 0; i < this._routes.length; i++) {\n\t\t\talt = this._routes[i];\n\t\t\taltDiv = this._createAlternative(alt, i);\n\t\t\tthis._container.appendChild(altDiv);\n\t\t\tthis._altElements.push(altDiv);\n\t\t}\n\n\t\tthis.fire('routeselected', {route: this._routes[0]});\n\n\t\treturn this;\n\t},\n\n\tshow: function() {\n\t\tL.DomUtil.removeClass(this._container, 'leaflet-routing-container-hide');\n\t},\n\n\thide: function() {\n\t\tL.DomUtil.addClass(this._container, 'leaflet-routing-container-hide');\n\t},\n\n\t_createAlternative: function(alt, i) {\n\t\tvar altDiv = L.DomUtil.create('div', 'leaflet-routing-alt ' +\n\t\t\tthis.options.alternativeClassName +\n\t\t\t(i > 0 ? ' leaflet-routing-alt-minimized ' + this.options.minimizedClassName : ''));\n\t\taltDiv.innerHTML = L.Util.template(this.options.summaryTemplate, {\n\t\t\tname: alt.name,\n\t\t\tdistance: this._formatDistance(alt.summary.totalDistance),\n\t\t\ttime: this._formatTime(alt.summary.totalTime)\n\t\t});\n\t\tL.DomEvent.addListener(altDiv, 'click', this._onAltClicked, this);\n\n\t\taltDiv.appendChild(this._createItineraryTable(alt));\n\t\treturn altDiv;\n\t},\n\n\t_clearAlts: function() {\n\t\tvar i,\n\t\t\talt;\n\t\t// TODO: this is really inelegant\n\t\tfor (i = 0; this._container && i < this._container.children.length; i++) {\n\t\t\talt = this._container.children[i];\n\t\t\tif (L.DomUtil.hasClass(alt, 'leaflet-routing-alt')) {\n\t\t\t\tthis._container.removeChild(alt);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\n\t\tthis._altElements = [];\n\t},\n\n\t_createItineraryTable: function(r) {\n\t\tvar table = L.DomUtil.create('table', this.options.itineraryClassName),\n\t\t    body = L.DomUtil.create('tbody', '', table),\n\t\t    i,\n\t\t    instr,\n\t\t    row,\n\t\t    td;\n\n\t\tfor (i = 0; i < r.instructions.length; i++) {\n\t\t\tinstr = r.instructions[i];\n\t\t\trow = L.DomUtil.create('tr', '', body);\n\t\t\ttd = L.DomUtil.create('td', '', row);\n\t\t\ttd.appendChild(document.createTextNode(this._instruction(instr, i)));\n\t\t\ttd = L.DomUtil.create('td', '', row);\n\t\t\ttd.appendChild(document.createTextNode(this._formatDistance(instr.distance)));\n\t\t\tthis._addRowListeners(row, r.coordinates[instr.index]);\n\t\t}\n\n\t\treturn table;\n\t},\n\n\t_addRowListeners: function(row, coordinate) {\n\t\tvar _this = this,\n\t\t    marker;\n\t\tL.DomEvent.addListener(row, 'mouseover', function() {\n\t\t\tmarker = L.circleMarker(coordinate,\n\t\t\t\t_this.options.pointMarkerStyle).addTo(_this._map);\n\t\t});\n\t\tL.DomEvent.addListener(row, 'mouseout', function() {\n\t\t\tif (marker) {\n\t\t\t\t_this._map.removeLayer(marker);\n\t\t\t\tmarker = null;\n\t\t\t}\n\t\t});\n\t\tL.DomEvent.addListener(row, 'click', function(e) {\n\t\t\t_this._map.panTo(coordinate);\n\t\t\tL.DomEvent.stopPropagation(e);\n\t\t});\n\t},\n\n\t_onAltClicked: function(e) {\n\t\tvar altElem,\n\t\t    j,\n\t\t    n,\n\t\t    isCurrentSelection,\n\t\t    classFn;\n\n\t\taltElem = e.target || window.event.srcElement;\n\t\twhile (!L.DomUtil.hasClass(altElem, 'leaflet-routing-alt')) {\n\t\t\taltElem = altElem.parentElement;\n\t\t}\n\n\t\tif (L.DomUtil.hasClass(altElem, 'leaflet-routing-alt-minimized')) {\n\t\t\tfor (j = 0; j < this._altElements.length; j++) {\n\t\t\t\tn = this._altElements[j];\n\t\t\t\tisCurrentSelection = altElem === n;\n\t\t\t\tclassFn = isCurrentSelection ? 'removeClass' : 'addClass';\n\t\t\t\tL.DomUtil[classFn](n, 'leaflet-routing-alt-minimized');\n\t\t\t\tif (this.options.minimizedClassName) {\n\t\t\t\t\tL.DomUtil[classFn](n, this.options.minimizedClassName);\n\t\t\t\t}\n\n\t\t\t\tif (isCurrentSelection) {\n\t\t\t\t\t// TODO: don't fire if the currently active is clicked\n\t\t\t\t\tthis.fire('routeselected', {route: this._routes[j]});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tL.DomEvent.stop(e);\n\t},\n\n\t_formatDistance: function(d /* Number (meters) */) {\n\t\tvar un = this.options.unitNames,\n\t\t    v,\n\t\t\tdata;\n\n\t\tif (this.options.units === 'imperial') {\n\t\t\td = d / 1.609344;\n\t\t\tif (d >= 1000) {\n\t\t\t\tdata = {\n\t\t\t\t\tvalue: (this._round(d) / 1000),\n\t\t\t\t\tunit: un.miles\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tdata = {\n\t\t\t\t\tvalue: this._round(d / 1.760),\n\t\t\t\t\tunit: un.yards\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\tv = this._round(d);\n\t\t\tdata = {\n\t\t\t\tvalue: v >= 1000 ? (v / 1000) : v,\n\t\t\t\tunit: v >= 1000 ? un.kilometers : un.meters\n\t\t\t};\n\t\t}\n\n\t\treturn L.Util.template(this.options.distanceTemplate, data);\n\t},\n\n\t_round: function(d) {\n\t\tvar pow10 = Math.pow(10, (Math.floor(d / this.options.roundingSensitivity) + '').length - 1),\n\t\t\tr = Math.floor(d / pow10),\n\t\t\tp = (r > 5) ? pow10 : pow10 / 2;\n\n\t\treturn Math.round(d / p) * p;\n\t},\n\n\t_formatTime: function(t /* Number (seconds) */) {\n\t\tif (t > 86400) {\n\t\t\treturn Math.round(t / 3600) + ' h';\n\t\t} else if (t > 3600) {\n\t\t\treturn Math.floor(t / 3600) + ' h ' +\n\t\t\t\tMath.round((t % 3600) / 60) + ' min';\n\t\t} else if (t > 300) {\n\t\t\treturn Math.round(t / 60) + ' min';\n\t\t} else if (t > 60) {\n\t\t\treturn Math.floor(t / 60) + ' min ' +\n\t\t\t\t(t % 60) + ' s';\n\t\t} else {\n\t\t\treturn t + ' s';\n\t\t}\n\t},\n\n\t_instruction: function(instr, i) {\n\t\tif (instr.type !== undefined) {\n\t\t\treturn L.Util.template(this._getInstructionTemplate(instr, i),\n\t\t\t\tL.extend({exit: this._formatOrder(instr.exit), dir: this._dir[instr.direction]},\n\t\t\t\t\tinstr));\n\t\t} else {\n\t\t\treturn instr.text;\n\t\t}\n\t},\n\n\t_getInstructionTemplate: function(instr, i) {\n\t\tswitch (instr.type) {\n\t\tcase 'Straight':\n\t\t\treturn (i === 0 ? 'Head' : 'Continue') + ' {dir}' + (instr.road ? ' on {road}' : '');\n\t\tcase 'SlightRight':\n\t\t\treturn 'Slight right' + (instr.road ? ' onto {road}' : '');\n\t\tcase 'Right':\n\t\t\treturn 'Right' + (instr.road ? ' onto {road}' : '');\n\t\tcase 'SharpRight':\n\t\t\treturn 'Sharp right' + (instr.road ? ' onto {road}' : '');\n\t\tcase 'TurnAround':\n\t\t\treturn 'Turn around';\n\t\tcase 'SharpLeft':\n\t\t\treturn 'Sharp left' + (instr.road ? ' onto {road}' : '');\n\t\tcase 'Left':\n\t\t\treturn 'Left' + (instr.road ? ' onto {road}' : '');\n\t\tcase 'SlightLeft':\n\t\t\treturn 'Slight left' + (instr.road ? ' onto {road}' : '');\n\t\tcase 'WaypointReached':\n\t\t\treturn 'Waypoint reached';\n\t\tcase 'Roundabout':\n\t\t\treturn  'Take the {exit} exit in the roundabout';\n\t\tcase 'DestinationReached':\n\t\t\treturn  'Destination reached';\n\t\t}\n\t},\n\n\t_formatOrder: function(n) {\n\t\tvar i = n % 10 - 1,\n\t\t\tsuffix = ['st', 'nd', 'rd'];\n\n\t\treturn suffix[i] ? n + suffix[i] : n + 'th';\n\t},\n\n\t_dir: {\n\t\tN: 'north',\n\t\tNE: 'northeast',\n\t\tE: 'east',\n\t\tSE: 'southeast',\n\t\tS: 'south',\n\t\tSW: 'southwest',\n\t\tW: 'west',\n\t\tNW: 'northwest'\n\t}\n});\n\nL.Routing.Itinerary._instructions = {\n};\n\nL.Routing.itinerary = function(router) {\n\treturn new L.Routing.Itinerary(router);\n};\n\nvar Waypoint = L.Class.extend({\n\t\tinitialize: function(latLng, name) {\n\t\t\tthis.latLng = latLng;\n\t\t\tthis.name = name;\n\t\t}\n\t});\n\n\nL.Routing.Plan = L.Class.extend({\n\tincludes: L.Mixin.Events,\n\n\toptions: {\n\t\tdragStyles: [\n\t\t\t{color: 'black', opacity: 0.15, weight: 7},\n\t\t\t{color: 'white', opacity: 0.8, weight: 4},\n\t\t\t{color: 'orange', opacity: 1, weight: 2, dashArray: '7,12'}\n\t\t],\n\t\tdraggableWaypoints: true,\n\t\taddWaypoints: true,\n\t\tmaxGeocoderTolerance: 200,\n\t\tautocompleteOptions: {},\n\t\tgeocodersClassName: '',\n\t\tgeocoderPlaceholder: function(i, numberWaypoints) {\n\t\t\treturn i === 0 ?\n\t\t\t\t'Start' :\n\t\t\t\t(i < numberWaypoints - 1 ?\n\t\t\t\t\t\t\t\t'Via ' + i :\n\t\t\t\t\t\t\t\t'End');\n\t\t},\n\t\tgeocoderClass: function() {\n\t\t\treturn '';\n\t\t}\n\t},\n\n\tinitialize: function(waypoints, options) {\n\t\tL.Util.setOptions(this, options);\n\t\tthis._waypoints = [];\n\t\tthis.setWaypoints(waypoints);\n\t},\n\n\tisReady: function() {\n\t\tvar i;\n\t\tfor (i = 0; i < this._waypoints.length; i++) {\n\t\t\tif (!this._waypoints[i].latLng) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tgetWaypoints: function() {\n\t\tvar i,\n\t\t\twps = [];\n\n\t\tfor (i = 0; i < this._waypoints.length; i++) {\n\t\t\twps.push(this._waypoints[i]);\n\t\t}\n\n\t\treturn wps;\n\t},\n\n\tsetWaypoints: function(waypoints) {\n\t\tvar args = [0, this._waypoints.length].concat(waypoints);\n\t\tthis.spliceWaypoints.apply(this, args);\n\t\treturn this;\n\t},\n\n\tspliceWaypoints: function() {\n\t\tvar args = [arguments[0], arguments[1]],\n\t\t    i,\n\t\t    wp;\n\n\t\tfor (i = 2; i < arguments.length; i++) {\n\t\t\targs.push(arguments[i] && arguments[i].hasOwnProperty('latLng') ? arguments[i] : new Waypoint(arguments[i]));\n\t\t}\n\n\t\t[].splice.apply(this._waypoints, args);\n\n\t\twhile (this._waypoints.length < 2) {\n\t\t\twp = new Waypoint();\n\t\t\tthis._waypoints.push(wp);\n\t\t\targs.push(wp);\n\t\t}\n\n\t\tthis._updateMarkers();\n\t\tthis._fireChanged.apply(this, args);\n\t},\n\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\t\tthis._updateMarkers();\n\t},\n\n\tonRemove: function() {\n\t\tvar i;\n\t\tthis._removeMarkers();\n\n\t\tif (this._newWp) {\n\t\t\tfor (i = 0; i < this._newWp.lines.length; i++) {\n\t\t\t\tthis._map.removeLayer(this._newWp.lines[i]);\n\t\t\t}\n\t\t}\n\n\t\tdelete this._map;\n\t},\n\n\tcreateGeocoders: function() {\n\t\tvar container = L.DomUtil.create('div', 'leaflet-routing-geocoders ' + this.options.geocodersClassName),\n\t\t\twaypoints = this._waypoints,\n\t\t    i,\n\t\t    geocoderElem,\n\t\t    addWpBtn;\n\n\t\tthis._geocoderContainer = container;\n\t\tthis._geocoderElems = [];\n\n\t\tfor (i = 0; i < waypoints.length; i++) {\n\t\t\tgeocoderElem = this._createGeocoder(i);\n\t\t\tcontainer.appendChild(geocoderElem);\n\t\t\tthis._geocoderElems.push(geocoderElem);\n\t\t}\n\n\t\taddWpBtn = L.DomUtil.create('button', '', container);\n\t\taddWpBtn.setAttribute('type', 'button');\n\t\taddWpBtn.innerHTML = '+';\n\t\tif (this.options.addWaypoints) {\n\t\t\tL.DomEvent.addListener(addWpBtn, 'click', function() {\n\t\t\t\tthis.spliceWaypoints(waypoints.length, 0, null);\n\t\t\t}, this);\n\t\t} else {\n\t\t\taddWpBtn.style.display = 'none';\n\t\t}\n\n\t\tthis.on('waypointsspliced', this._updateGeocoders);\n\n\t\treturn container;\n\t},\n\n\t_createGeocoder: function(i) {\n\t\tvar geocoderElem = L.DomUtil.create('input', ''),\n\t\t\twp = this._waypoints[i];\n\t\tgeocoderElem.setAttribute('placeholder', this.options.geocoderPlaceholder(i, this._waypoints.length));\n\t\tgeocoderElem.className = this.options.geocoderClass(i, this._waypoints.length);\n\n\t\tthis._updateWaypointName(i, geocoderElem);\n\t\t// This has to be here, or geocoder's value will not be properly\n\t\t// initialized.\n\t\t// TODO: look into why and make _updateWaypointName fix this.\n\t\tgeocoderElem.value = wp.name;\n\n\t\tL.DomEvent.addListener(geocoderElem, 'click', function() {\n\t\t\tthis.select();\n\t\t}, geocoderElem);\n\n\t\tnew L.Routing.Autocomplete(geocoderElem, function(r) {\n\t\t\t\tgeocoderElem.value = r.name;\n\t\t\t\twp.name = r.name;\n\t\t\t\twp.latLng = r.center;\n\t\t\t\tthis._updateMarkers();\n\t\t\t\tthis._fireChanged();\n\t\t\t}, this, L.extend({\n\t\t\t\tresultFn: this.options.geocoder.geocode,\n\t\t\t\tresultContext: this.options.geocoder,\n\t\t\t\tautocompleteFn: this.options.geocoder.suggest,\n\t\t\t\tautocompleteContext: this.options.geocoder\n\t\t\t}, this.options.autocompleteOptions));\n\n\t\treturn geocoderElem;\n\t},\n\n\t_updateGeocoders: function(e) {\n\t\tvar newElems = [],\n\t\t    i,\n\t\t    geocoderElem,\n\t\t    beforeElem;\n\n\t\t// Determine where to insert geocoders for new waypoints\n\t\tif (e.index >= this._geocoderElems.length) {\n\t\t\t// lastChild is the \"add new wp\" button\n\t\t\tbeforeElem = this._geocoderContainer.lastChild;\n\t\t} else {\n\t\t\tbeforeElem = this._geocoderElems[e.index];\n\t\t}\n\n\t\t// Insert new geocoders for new waypoints\n\t\tfor (i = 0; i < e.added.length; i++) {\n\t\t\tgeocoderElem = this._createGeocoder(e.index + i);\n\t\t\tthis._geocoderContainer.insertBefore(geocoderElem, beforeElem);\n\t\t\tnewElems.push(geocoderElem);\n\t\t}\n\t\t//newElems.reverse();\n\n\t\tfor (i = e.index; i < e.index + e.nRemoved; i++) {\n\t\t\tthis._geocoderContainer.removeChild(this._geocoderElems[i]);\n\t\t}\n\n\t\tnewElems.splice(0, 0, e.index, e.nRemoved);\n\t\t[].splice.apply(this._geocoderElems, newElems);\n\n\t\tfor (i = 0; i < this._geocoderElems.length; i++) {\n\t\t\tthis._geocoderElems[i].placeholder = this.options.geocoderPlaceholder(i, this._waypoints.length);\n\t\t\tthis._geocoderElems[i].className = this.options.geocoderClass(i, this._waypoints.length);\n\t\t}\n\t},\n\n\t_updateGeocoder: function(i, geocoderElem) {\n\t\tvar wp = this._waypoints[i],\n\t\t    value = wp && wp.name ? wp.name : '';\n\t\tgeocoderElem.value = value;\n\t},\n\n\t_updateWaypointName: function(i, geocoderElem, force) {\n\t\tvar wp = this._waypoints[i];\n\n\t\twp.name = wp.name || '';\n\n\t\tif (wp.latLng && (force || !wp.name)) {\n\t\t\tif (this.options.geocoder && this.options.geocoder.reverse) {\n\t\t\t\tthis.options.geocoder.reverse(wp.latLng, 67108864 /* zoom 18 */, function(rs) {\n\t\t\t\t\tif (rs.length > 0 && rs[0].center.distanceTo(wp.latLng) < this.options.maxGeocoderTolerance) {\n\t\t\t\t\t\twp.name = rs[0].name;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twp.name = '';\n\t\t\t\t\t}\n\t\t\t\t\tthis._updateGeocoder(i, geocoderElem);\n\t\t\t\t}, this);\n\t\t\t} else {\n\t\t\t\twp.name = '';\n\t\t\t}\n\n\t\t\tthis._updateGeocoder(i, geocoderElem);\n\t\t}\n\n\t},\n\n\t_removeMarkers: function() {\n\t\tvar i;\n\t\tif (this._markers) {\n\t\t\tfor (i = 0; i < this._markers.length; i++) {\n\t\t\t\tif (this._markers[i]) {\n\t\t\t\t\tthis._map.removeLayer(this._markers[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._markers = [];\n\t},\n\n\t_updateMarkers: function() {\n\t\tvar i,\n\t\t    icon,\n\t\t    m;\n\n\t\tif (!this._map) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._removeMarkers();\n\n\t\tfor (i = 0; i < this._waypoints.length; i++) {\n\t\t\tif (this._waypoints[i].latLng) {\n\t\t\t\ticon = (typeof(this.options.waypointIcon) === 'function') ?\n\t\t\t\t\tthis.options.waypointIcon(i, this._waypoints[i].name, this._waypoints.length) :\n\t\t\t\t\tthis.options.waypointIcon;\n\t\t\t\tm = this._createMarker(icon, i);\n\t\t\t\tif (this.options.draggableWaypoints) {\n\t\t\t\t\tthis._hookWaypointEvents(m, i);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tm = null;\n\t\t\t}\n\t\t\tthis._markers.push(m);\n\t\t}\n\t},\n\n\t_createMarker: function(icon, i) {\n\t\tvar options = {\n\t\t\tdraggable: true\n\t\t};\n\t\tif (icon) {\n\t\t\toptions.icon = icon;\n\t\t}\n\n\t\treturn L.marker(this._waypoints[i].latLng, options).addTo(this._map);\n\t},\n\n\t_fireChanged: function() {\n\t\tthis.fire('waypointschanged', {waypoints: this.getWaypoints()});\n\n\t\tif (arguments.length >= 2) {\n\t\t\tthis.fire('waypointsspliced', {\n\t\t\t\tindex: Array.prototype.shift.call(arguments),\n\t\t\t\tnRemoved: Array.prototype.shift.call(arguments),\n\t\t\t\tadded: arguments\n\t\t\t});\n\t\t}\n\t},\n\n\t_hookWaypointEvents: function(m, i) {\n\t\tm.on('dragstart', function(e) {\n\t\t\tthis.fire('waypointdragstart', this._createWaypointEvent(i, e));\n\t\t}, this);\n\t\tm.on('drag', function(e) {\n\t\t\tthis.fire('waypointdrag', this._createWaypointEvent(i, e));\n\t\t}, this);\n\t\tm.on('dragend', function(e) {\n\t\t\tthis.fire('waypointdragend', this._createWaypointEvent(i, e));\n\t\t\tthis._waypoints[i].latLng = e.target.getLatLng();\n\t\t\tthis._waypoints[i].name = '';\n\t\t\tthis._updateWaypointName(i, this._geocoderElems[i], true);\n\t\t\tthis._fireChanged();\n\t\t}, this);\n\t},\n\n\t_createWaypointEvent: function(i, e) {\n\t\treturn {index: i, latlng: e.target.getLatLng()};\n\t},\n\n\tdragNewWaypoint: function(e) {\n\t\tvar i;\n\t\tthis._newWp = {\n\t\t\tafterIndex: e.afterIndex,\n\t\t\tmarker: L.marker(e.latlng).addTo(this._map),\n\t\t\tlines: []\n\t\t};\n\n\t\tfor (i = 0; i < this.options.dragStyles.length; i++) {\n\t\t\tthis._newWp.lines.push(L.polyline([\n\t\t\t\tthis._waypoints[e.afterIndex].latLng,\n\t\t\t\te.latlng,\n\t\t\t\tthis._waypoints[e.afterIndex + 1].latLng\n\t\t\t], this.options.dragStyles[i]).addTo(this._map));\n\t\t}\n\n\t\tthis._markers.splice(e.afterIndex + 1, 0, this._newWp.marker);\n\t\tthis._map.on('mousemove', this._onDragNewWp, this);\n\t\tthis._map.on('mouseup', this._onWpRelease, this);\n\t},\n\n\t_onDragNewWp: function(e) {\n\t\tvar i;\n\t\tthis._newWp.marker.setLatLng(e.latlng);\n\t\tfor (i = 0; i < this._newWp.lines.length; i++) {\n\t\t\tthis._newWp.lines[i].spliceLatLngs(1, 1, e.latlng);\n\t\t}\n\t},\n\n\t_onWpRelease: function(e) {\n\t\tvar i;\n\t\tthis._map.off('mouseup', this._onWpRelease, this);\n\t\tthis._map.off('mousemove', this._onDragNewWp, this);\n\t\tfor (i = 0; i < this._newWp.lines.length; i++) {\n\t\t\tthis._map.removeLayer(this._newWp.lines[i]);\n\t\t}\n\t\tthis.spliceWaypoints(this._newWp.afterIndex + 1, 0, e.latlng);\n\t\tdelete this._newWp;\n\t}\n});\n\nL.Routing.plan = function(waypoints, options) {\n\treturn new L.Routing.Plan(waypoints, options);\n};\n\nL.Routing.Control = L.Routing.Itinerary.extend({\n\toptions: {\n\t\tfitSelectedRoutes: true\n\t},\n\n\tinitialize: function(options) {\n\t\tL.Util.setOptions(this, options);\n\n\t\tthis._router = this.options.router || new L.Routing.OSRM();\n\t\tthis._plan = this.options.plan || L.Routing.plan(undefined, { geocoder: this.options.geocoder });\n\t\tif (this.options.geocoder) {\n\t\t\tthis._plan.options.geocoder = this.options.geocoder;\n\t\t}\n\t\tif (this.options.waypoints) {\n\t\t\tthis._plan.setWaypoints(this.options.waypoints);\n\t\t}\n\n\t\tL.Routing.Itinerary.prototype.initialize.call(this, options);\n\n\t\tthis.on('routeselected', this._routeSelected, this);\n\t\tthis._plan.on('waypointschanged', function(e) {\n\t\t\tthis._route();\n\t\t\tthis.fire('waypointschanged', {waypoints: e.waypoints});\n\t\t}, this);\n\n\t\tthis._route();\n\t},\n\n\tonAdd: function(map) {\n\t\tvar container = L.Routing.Itinerary.prototype.onAdd.call(this, map);\n\n\t\tthis._map = map;\n\t\tthis._map.addLayer(this._plan);\n\n\t\tif (this.options.geocoder) {\n\t\t\tcontainer.insertBefore(this._plan.createGeocoders(), container.firstChild);\n\t\t}\n\n\t\treturn container;\n\t},\n\n\tonRemove: function(map) {\n\t\tif (this._line) {\n\t\t\tmap.removeLayer(this._line);\n\t\t}\n\t\tmap.removeLayer(this._plan);\n\t\treturn L.Routing.Itinerary.prototype.onRemove.call(this, map);\n\t},\n\n\tgetWaypoints: function() {\n\t\treturn this._plan.getWaypoints();\n\t},\n\n\tsetWaypoints: function(waypoints) {\n\t\tthis._plan.setWaypoints(waypoints);\n\t\treturn this;\n\t},\n\n\tspliceWaypoints: function() {\n\t\tvar removed = this._plan.spliceWaypoints.apply(this._plan, arguments);\n\t\treturn removed;\n\t},\n\n\tgetPlan: function() {\n\t\treturn this._plan;\n\t},\n\n\t_routeSelected: function(e) {\n\t\tvar route = e.route;\n\t\tthis._clearLine();\n\n\t\tthis._line = L.Routing.line(route, this.options.lineOptions);\n\t\tthis._line.addTo(this._map);\n\t\tthis._hookEvents(this._line);\n\n\t\tif (this.options.fitSelectedRoutes) {\n\t\t\tthis._map.fitBounds(this._line.getBounds());\n\t\t}\n\t},\n\n\t_hookEvents: function(l) {\n\t\tl.on('linetouched', function(e) {\n\t\t\tthis._plan.dragNewWaypoint(e);\n\t\t}, this);\n\t},\n\n\t_route: function() {\n\t\tvar wps;\n\n\t\tthis._clearLine();\n\t\tthis._clearAlts();\n\n\t\tif (this._plan.isReady()) {\n\t\t\twps = this._plan.getWaypoints();\n\t\t\tthis.fire('routingstart', {waypoints: wps});\n\t\t\tthis._router.route(wps, function(err, routes) {\n\t\t\t\tif (err) {\n\t\t\t\t\tthis.fire('routingerror', {error: err});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.fire('routesfound', {waypoints: wps, routes: routes});\n\t\t\t\tthis.setAlternatives(routes);\n\t\t\t}, this);\n\t\t}\n\t},\n\n\t_clearLine: function() {\n\t\tif (this._line) {\n\t\t\tthis._map.removeLayer(this._line);\n\t\t\tdelete this._line;\n\t\t}\n\t}\n});\n\nL.Routing.control = function(options) {\n\treturn new L.Routing.Control(options);\n};"]}